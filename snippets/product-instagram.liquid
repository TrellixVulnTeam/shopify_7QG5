{% if section.settings.show_instagram %}

{{ 'instafeed.min.js' | asset_url | script_tag }}

<section class="product-instagram instagram" id="new-instagram-{{section.id}}">
    <div class="container">
        {% if section.settings.instagram_title != blank %}
        <div class="widget-title">   
            <h3 class="box-title">
                {% render 'multilang' with section.settings.instagram_title %}
            </h3>
            {% if section.settings.instagram_des != blank %}
            <p>
                {% render 'multilang' with section.settings.instagram_des %}
            </p>        
            {% endif %}
        </div>
        {% endif %}

        <div id="instafeed" class="row" data-instagram-feed data-limit="{{ section.settings.limit }}" data-rows="4"></div>  
    </div>

</section>

<style>

    {% assign instagram_bg =  section.settings.instagram_bg %}    
    #new-instagram-{{section.id}},
    #new-instagram-{{section.id}} .widget-title .box-title .title {
        background-color: {{ instagram_bg }};
    }	

</style>

<script>
    $(document).ready(function() {
        var instagramBlock = $('[data-instagram-feed]');

        instagramBlock.each(function() {
            var self = $(this),
                dataRows = self.data('rows'),
                dataLimit = self.data('limit');
                
            var feed = new Instafeed({
                get: "user",   
                {% if section.settings.accessToken != blank %}
                userId: {{ section.settings.accessToken | split: '.' | first  }},
                accessToken: '{{ section.settings.accessToken }}', 
                {% else %}
                accessToken: '12156328409.1677ed0.10d7d8b52fe44349aaf482d0e299c28b',
                userId: 8944927192,
                {% endif %}
                resolution: "{{ section.settings.resolution_images }}",
                clientId: "c6e4c736e82345a3898a0e299daa00fb",
                get limit() {
                    return limit = dataLimit.toString();          
                },          

                after: function() {
                    self.find('a').attr({
                        target: "_blank",
                        class: "item col-12 animate-hvr"
                    });            

                    self.slick({
                        infinite: true,
                        speed: 1000,                       
                        {% if section.settings.display_arrow %}
                        nextArrow: '<button type="button" class="slick-next"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30" viewBox="0 0 20 20"><path d="M5 20c-0.128 0-0.256-0.049-0.354-0.146-0.195-0.195-0.195-0.512 0-0.707l8.646-8.646-8.646-8.646c-0.195-0.195-0.195-0.512 0-0.707s0.512-0.195 0.707 0l9 9c0.195 0.195 0.195 0.512 0 0.707l-9 9c-0.098 0.098-0.226 0.146-0.354 0.146z"></path></svg></button>',
                        prevArrow: '<button type="button" class="slick-prev"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30" viewBox="0 0 20 20"><path d="M14 20c0.128 0 0.256-0.049 0.354-0.146 0.195-0.195 0.195-0.512 0-0.707l-8.646-8.646 8.646-8.646c0.195-0.195 0.195-0.512 0-0.707s-0.512-0.195-0.707 0l-9 9c-0.195 0.195-0.195 0.512 0 0.707l9 9c0.098 0.098 0.226 0.146 0.354 0.146z"></path></svg></button>',
                        {% else %}
                        arrows: false,
                        autoplay: true,
                        {% endif %}
                        slidesToShow: dataRows,
                        slidesToScroll: dataRows,
                        responsive: [
                            {
                                breakpoint: 1200,
                                settings: {
                                    slidesToShow: 4,
                                    slidesToScroll: 4,
                                }
                            },
                            {
                                breakpoint: 1025,
                                settings: {
                                    slidesToShow: 4,
                                    slidesToScroll: 4,
                                    arrows: false,
                                    dots: true
                                }
                            },
                            {
                                breakpoint: 992,
                                settings: {
                                      slidesToShow: 3,
                                    slidesToScroll: 3,
                                    arrows: false,
                                    dots: true        
                                }
                            },
                            {
                                breakpoint: 768,
                                settings: {
                                    slidesToShow: 2,
                                    slidesToScroll: 2,
                                    arrows: false,
                                    dots: true   
                                }
                            }                                          
                        ]
                    });
                }
            });

            feed.run();
        });
    });
</script>

{% endif %}
